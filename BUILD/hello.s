;
; File generated by cc65 v 2.19 - Git 4680d68
;
	.fopt		compiler,"cc65 v 2.19 - Git 4680d68"
	.setcpu		"6502"
	.smart		on
	.autoimport	on
	.case		on
	.debuginfo	off
	.importzp	c_sp, sreg, regsave, regbank
	.importzp	tmp1, tmp2, tmp3, tmp4, ptr1, ptr2, ptr3, ptr4
	.macpack	longbranch
	.forceimport	__STARTUP__
	.import		_pal_bg
	.import		_pal_spr
	.import		_ppu_wait_nmi
	.import		_ppu_off
	.import		_ppu_on_all
	.import		_oam_clear
	.import		_oam_spr
	.import		_pad_poll
	.import		_vram_adr
	.import		_vram_put
	.export		_i
	.export		_j
	.export		_pad1
	.export		_p1_facing
	.export		_p1_x
	.export		_p1_y
	.export		_b1_x
	.export		_b1_y
	.export		_b1
	.export		_p1_dy
	.export		_p1_dx
	.export		_b1_vx
	.export		_pad2
	.export		_p2_facing
	.export		_p2_x
	.export		_p2_y
	.export		_b2_x
	.export		_b2_y
	.export		_b2
	.export		_p2_dy
	.export		_p2_dx
	.export		_b2_vx
	.export		_platforms
	.export		_palette
	.export		_main

.segment	"RODATA"

_platforms:
	.byte	$28
	.byte	$B4
	.byte	$30
	.byte	$8C
	.byte	$B4
	.byte	$30
	.byte	$64
	.byte	$9B
	.byte	$20
_palette:
	.byte	$0F
	.byte	$16
	.byte	$28
	.byte	$30
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$00
	.byte	$00

.segment	"BSS"

.segment	"ZEROPAGE"
.segment	"ZEROPAGE"
_i:
	.res	1,$00
_j:
	.res	1,$00
_pad1:
	.res	1,$00
_p1_facing:
	.res	1,$00
_p1_x:
	.res	1,$00
_p1_y:
	.res	1,$00
_b1_x:
	.res	1,$00
_b1_y:
	.res	1,$00
_b1:
	.res	1,$00
_p1_dy:
	.res	1,$00
_p1_dx:
	.res	1,$00
_b1_vx:
	.res	1,$00
_pad2:
	.res	1,$00
_p2_facing:
	.res	1,$00
_p2_x:
	.res	1,$00
_p2_y:
	.res	1,$00
_b2_x:
	.res	1,$00
_b2_y:
	.res	1,$00
_b2:
	.res	1,$00
_p2_dy:
	.res	1,$00
_p2_dx:
	.res	1,$00
_b2_vx:
	.res	1,$00

; ---------------------------------------------------------------
; void __near__ main (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_main: near

.segment	"CODE"

;
; p1_x = 40;
;
	lda     #$28
	sta     _p1_x
;
; p2_x = 200;
;
	lda     #$C8
	sta     _p2_x
;
; p1_y = 200;
;
	sta     _p1_y
;
; p2_y = 200;
;
	sta     _p2_y
;
; p1_dy = 0;
;
	lda     #$00
	sta     _p1_dy
;
; p1_dx = 0;
;
	sta     _p1_dx
;
; p2_dy = 0;
;
	sta     _p2_dy
;
; p2_dx = 0;
;
	sta     _p2_dx
;
; ppu_off(); // screen off
;
	jsr     _ppu_off
;
; pal_bg(palette); // load the BG palette
;
	lda     #<(_palette)
	ldx     #>(_palette)
	jsr     _pal_bg
;
; pal_spr(palette); // load the sprite palette
;
	lda     #<(_palette)
	ldx     #>(_palette)
	jsr     _pal_spr
;
; vram_adr(NTADR_A(0,26)); // screen is 32 x 30 tiles
;
	ldx     #$23
	lda     #$40
	jsr     _vram_adr
;
; for (i=0; i<32; ++i){
;
	lda     #$00
	sta     _i
L00F3:	lda     _i
	cmp     #$20
	bcs     L00F4
;
; vram_put(0x01);
;
	lda     #$01
	jsr     _vram_put
;
; for (i=0; i<32; ++i){
;
	inc     _i
	jmp     L00F3
;
; for (i = 0; i < 3; i++){
;
L00F4:	lda     #$00
	sta     _i
L00F5:	lda     _i
	cmp     #$03
	jcs     L0007
;
; vram_adr(NTADR_A((platforms[i].x + j) / 8 , platforms[i].y / 8));
;
	ldx     #$00
	lda     _i
	jsr     mulax3
	clc
	adc     #<(_platforms)
	sta     ptr1
	txa
	adc     #>(_platforms)
	sta     ptr1+1
	ldy     #$01
	ldx     #$00
	lda     (ptr1),y
	lsr     a
	lsr     a
	lsr     a
	jsr     aslax4
	stx     tmp1
	asl     a
	rol     tmp1
	ldx     tmp1
	sta     sreg
	stx     sreg+1
	ldx     #$00
	lda     _i
	jsr     mulax3
	sta     ptr1
	txa
	clc
	adc     #>(_platforms)
	sta     ptr1+1
	ldy     #<(_platforms)
	ldx     #$00
	lda     (ptr1),y
	clc
	adc     _j
	bcc     L00DE
	inx
L00DE:	cpx     #$00
	bpl     L000A
	sta     regsave
	stx     regsave+1
	cpx     #$FF
	bne     L000C
	cmp     #$F9
L000C:	jsr     boolult
	lsr     a
	lda     regsave
	ldx     regsave+1
	bcs     L000A
	ldx     #$00
	txa
	jmp     L000B
L000A:	jsr     asrax3
L000B:	ora     sreg
	pha
	txa
	ora     sreg+1
	tax
	pla
	pha
	txa
	ora     #$20
	tax
	pla
	jsr     _vram_adr
;
; for(j = 0; j < (platforms[i].w / 8); j++){
;
	lda     #$00
	sta     _j
	tax
L00F6:	lda     _i
	jsr     mulax3
	clc
	adc     #<(_platforms)
	sta     ptr1
	txa
	adc     #>(_platforms)
	sta     ptr1+1
	ldy     #$02
	lda     (ptr1),y
	lsr     a
	lsr     a
	lsr     a
	cmp     _j
	bcc     L00F7
	beq     L00F7
;
; vram_put(0x01);
;
	lda     #$01
	jsr     _vram_put
;
; for(j = 0; j < (platforms[i].w / 8); j++){
;
	ldx     #$00
	inc     _j
	jmp     L00F6
;
; for (i = 0; i < 3; i++){
;
L00F7:	inc     _i
	jmp     L00F5
;
; ppu_on_all(); // turn on screen
;
L0007:	jsr     _ppu_on_all
;
; ppu_wait_nmi();
;
L0011:	jsr     _ppu_wait_nmi
;
; oam_clear(); 
;
	jsr     _oam_clear
;
; pad1 = pad_poll(0);
;
	lda     #$00
	jsr     _pad_poll
	sta     _pad1
;
; pad2 = pad_poll(1);
;
	lda     #$01
	jsr     _pad_poll
	sta     _pad2
;
; if(pad1 & PAD_LEFT){
;
	lda     _pad1
	and     #$02
	beq     L00F8
;
; p1_facing = 0;
;
	lda     #$00
	sta     _p1_facing
;
; if(p1_dx > -3) --p1_dx;
;
	lda     _p1_dx
	sec
	sbc     #$FE
	bvs     L0017
	eor     #$80
L0017:	bpl     L00FB
	dec     _p1_dx
	bpl     L00FB
;
; else if(pad1 & PAD_RIGHT){
;
	jmp     L00FB
L00F8:	lda     _pad1
	and     #$01
	beq     L00F9
;
; p1_facing = 1;
;
	lda     #$01
	sta     _p1_facing
;
; if(p1_dx < 3) ++p1_dx;
;
	lda     _p1_dx
	sec
	sbc     #$03
	bvc     L001D
	eor     #$80
L001D:	bpl     L00FB
	inc     _p1_dx
	bpl     L00FB
;
; else{
;
	jmp     L00FB
;
; if(p1_dx > 0) --p1_dx;
;
L00F9:	lda     _p1_dx
	sec
	sbc     #$01
	bvs     L0022
	eor     #$80
L0022:	bpl     L00FA
	dec     _p1_dx
;
; if(p1_dx < 0) ++p1_dx;
;
L00FA:	lda     _p1_dx
	asl     a
	bcc     L00FB
	inc     _p1_dx
;
; if(p1_dx > 0 && p1_x < 255) p1_x += p1_dx;
;
L00FB:	lda     _p1_dx
	sec
	sbc     #$01
	bvs     L0029
	eor     #$80
L0029:	bpl     L0101
	lda     _p1_x
	cmp     #$FF
	bcs     L0101
	lda     _p1_dx
	clc
	adc     _p1_x
	sta     _p1_x
;
; if(p1_dx < 0 && p1_x > 0) p1_x += p1_dx;
;
L0101:	lda     _p1_dx
	asl     a
	bcc     L0107
	lda     _p1_x
	beq     L0107
	lda     _p1_dx
	clc
	adc     _p1_x
	sta     _p1_x
;
; if((pad1 & PAD_A) && ((p1_y == FLOOR_Y) || 
;
L0107:	lda     _pad1
	and     #$80
	jeq     L0115
	lda     _p1_y
	cmp     #$C0
	jeq     L0114
;
; ( (p1_y < FLOOR_Y) && (p1_y >= (platforms[0].y - 22)) && (p1_x + 8 > platforms[0].x) && (p1_x < platforms[0].x + platforms[0].w) ) ||
;
	cmp     #$C0
	bcs     L0109
	lda     _p1_y
	jsr     pusha0
	lda     _platforms+1
	sec
	sbc     #$16
	bcs     L0038
	ldx     #$FF
L0038:	jsr     tosicmp
	bmi     L0109
	ldx     #$00
	lda     _p1_x
	clc
	adc     #$08
	bcc     L0039
	inx
L0039:	jsr     pushax
	lda     _platforms
	jsr     tosicmp0
	bmi     L0109
	beq     L0109
	lda     _p1_x
	jsr     pusha0
	lda     _platforms
	clc
	adc     _platforms+2
	bcc     L00DF
	ldx     #$01
L00DF:	jsr     tosicmp
	jmi     L0114
;
; ( (p1_y < FLOOR_Y) && (p1_y >= (platforms[1].y - 22)) && (p1_x + 8 > platforms[1].x) && (p1_x < platforms[1].x + platforms[1].w) ) ||
;
L0109:	lda     _p1_y
	cmp     #$C0
	bcs     L010B
	lda     _p1_y
	jsr     pusha0
	lda     _platforms+4
	sec
	sbc     #$16
	bcs     L003D
	ldx     #$FF
L003D:	jsr     tosicmp
	bmi     L010B
	ldx     #$00
	lda     _p1_x
	clc
	adc     #$08
	bcc     L003E
	inx
L003E:	jsr     pushax
	lda     _platforms+3
	jsr     tosicmp0
	bmi     L010B
	beq     L010B
	lda     _p1_x
	jsr     pusha0
	lda     _platforms+3
	clc
	adc     _platforms+5
	bcc     L00E0
	ldx     #$01
L00E0:	jsr     tosicmp
	bmi     L0114
;
; ( (p1_y < FLOOR_Y) && (p1_y >= (platforms[2].y - 22)) && (p1_x + 8 > platforms[2].x) && (p1_x < platforms[2].x + platforms[2].w) ) ) ){
;
L010B:	lda     _p1_y
	cmp     #$C0
	bcs     L0115
	lda     _p1_y
	jsr     pusha0
	lda     _platforms+7
	sec
	sbc     #$16
	bcs     L0042
	ldx     #$FF
L0042:	jsr     tosicmp
	bmi     L0115
	ldx     #$00
	lda     _p1_x
	clc
	adc     #$08
	bcc     L0043
	inx
L0043:	jsr     pushax
	lda     _platforms+6
	jsr     tosicmp0
	bmi     L0115
	beq     L0115
	lda     _p1_x
	jsr     pusha0
	lda     _platforms+6
	clc
	adc     _platforms+8
	bcc     L00E1
	ldx     #$01
L00E1:	jsr     tosicmp
	bpl     L0115
;
; p1_dy = -8;
;
L0114:	lda     #$F8
	sta     _p1_dy
;
; if (p1_dy < 4) p1_dy += 1;
;
L0115:	lda     _p1_dy
	sec
	sbc     #$04
	bvc     L004B
	eor     #$80
L004B:	bpl     L0116
	inc     _p1_dy
;
; p1_y += p1_dy;
;
L0116:	lda     _p1_dy
	clc
	adc     _p1_y
	sta     _p1_y
;
; if(p1_dy >= 0){
;
	ldx     _p1_dy
	jmi     L011D
;
; if(p1_y >= FLOOR_Y){
;
	lda     _p1_y
	cmp     #$C0
	lda     #$00
	bcc     L011A
;
; p1_y = FLOOR_Y;
;
	lda     #$C0
	sta     _p1_y
;
; p1_dy = 0;
;
	lda     #$00
	sta     _p1_dy
;
; for(i = 0; i < 3; i++){
;
L011A:	sta     _i
L011B:	lda     _i
	cmp     #$03
	jcs     L011D
;
; if (p1_y >= (platforms[i].y-22) && p1_y < (platforms[i].y-22) + 8){
;
	lda     _p1_y
	jsr     pusha0
	lda     _i
	jsr     mulax3
	clc
	adc     #<(_platforms)
	sta     ptr1
	txa
	adc     #>(_platforms)
	sta     ptr1+1
	ldy     #$01
	ldx     #$00
	lda     (ptr1),y
	sec
	sbc     #$16
	bcs     L0056
	dex
L0056:	jsr     tosicmp
	jmi     L011C
	lda     _p1_y
	jsr     pusha0
	lda     _i
	jsr     mulax3
	clc
	adc     #<(_platforms)
	sta     ptr1
	txa
	adc     #>(_platforms)
	sta     ptr1+1
	ldy     #$01
	ldx     #$00
	lda     (ptr1),y
	sec
	sbc     #$16
	bcs     L0058
	dex
L0058:	clc
	adc     #$08
	bcc     L0059
	inx
L0059:	jsr     tosicmp
	jpl     L011C
;
; if (p1_x + 8 > platforms[i].x && p1_x < platforms[i].x + platforms[i].w){
;
	ldx     #$00
	lda     _p1_x
	clc
	adc     #$08
	bcc     L005D
	inx
L005D:	jsr     pushax
	ldx     #$00
	lda     _i
	jsr     mulax3
	sta     ptr1
	txa
	clc
	adc     #>(_platforms)
	sta     ptr1+1
	ldy     #<(_platforms)
	lda     (ptr1),y
	jsr     tosicmp0
	bmi     L011C
	beq     L011C
	lda     _p1_x
	jsr     pusha0
	lda     _i
	jsr     mulax3
	sta     ptr1
	txa
	clc
	adc     #>(_platforms)
	sta     ptr1+1
	ldy     #<(_platforms)
	lda     (ptr1),y
	sta     sreg
	ldx     #$00
	lda     _i
	jsr     mulax3
	clc
	adc     #<(_platforms)
	sta     ptr1
	txa
	adc     #>(_platforms)
	sta     ptr1+1
	ldy     #$02
	ldx     #$00
	lda     (ptr1),y
	clc
	adc     sreg
	bcc     L00E5
	inx
L00E5:	jsr     tosicmp
	bpl     L011C
;
; p1_y = (platforms[i].y-22);
;
	ldx     #$00
	lda     _i
	jsr     mulax3
	clc
	adc     #<(_platforms)
	sta     ptr1
	txa
	adc     #>(_platforms)
	sta     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	sec
	sbc     #$16
	sta     _p1_y
;
; p1_dy = 0;
;
	lda     #$00
	sta     _p1_dy
;
; for(i = 0; i < 3; i++){
;
L011C:	inc     _i
	jmp     L011B
;
; if( (pad1 & PAD_B) && (b1 == 0)){
;
L011D:	lda     _pad1
	and     #$40
	beq     L0122
	lda     _b1
	bne     L0122
;
; b1_y = p1_y + 2;
;
	lda     _p1_y
	clc
	adc     #$02
	sta     _b1_y
;
; b1 = 1;
;
	lda     #$01
	sta     _b1
;
; if(p1_facing == 0){
;
	lda     _p1_facing
	bne     L0121
;
; b1_x = p1_x - 4;
;
	lda     _p1_x
	sec
	sbc     #$04
	sta     _b1_x
;
; b1_vx = -4;
;
	lda     #$FC
	sta     _b1_vx
;
; p1_dx = 8;
;
	lda     #$08
;
; } else {
;
	jmp     L00EE
;
; b1_x = p1_x + 4;
;
L0121:	lda     _p1_x
	clc
	adc     #$04
	sta     _b1_x
;
; b1_vx = 4;
;
	lda     #$04
	sta     _b1_vx
;
; p1_dx = -8;
;
	lda     #$F8
L00EE:	sta     _p1_dx
;
; if(b1 == 1){
;
L0122:	lda     _b1
	cmp     #$01
	bne     L0125
;
; oam_spr(b1_x, b1_y, 0x02, 0);
;
	jsr     decsp3
	lda     _b1_x
	ldy     #$02
	sta     (c_sp),y
	lda     _b1_y
	dey
	sta     (c_sp),y
	lda     #$02
	dey
	sta     (c_sp),y
	tya
	jsr     _oam_spr
;
; b1_x += b1_vx;
;
	lda     _b1_vx
	clc
	adc     _b1_x
	sta     _b1_x
;
; if(b1_x > 250) b1 = 0;
;
	cmp     #$FB
	bcc     L0125
	lda     #$00
	sta     _b1
;
; if(pad2 & PAD_LEFT){
;
L0125:	lda     _pad2
	and     #$02
	beq     L0126
;
; p2_facing = 0;
;
	lda     #$00
	sta     _p2_facing
;
; if(p2_dx > -3) --p2_dx;
;
	lda     _p2_dx
	sec
	sbc     #$FE
	bvs     L0071
	eor     #$80
L0071:	bpl     L0129
	dec     _p2_dx
	bpl     L0129
;
; else if(pad2 & PAD_RIGHT){
;
	jmp     L0129
L0126:	lda     _pad2
	and     #$01
	beq     L0127
;
; p2_facing = 1;
;
	lda     #$01
	sta     _p2_facing
;
; if(p2_dx < 3) ++p2_dx;
;
	lda     _p2_dx
	sec
	sbc     #$03
	bvc     L0077
	eor     #$80
L0077:	bpl     L0129
	inc     _p2_dx
	bpl     L0129
;
; else{
;
	jmp     L0129
;
; if(p2_dx > 0) --p2_dx;
;
L0127:	lda     _p2_dx
	sec
	sbc     #$01
	bvs     L007C
	eor     #$80
L007C:	bpl     L0128
	dec     _p2_dx
;
; if(p2_dx < 0) ++p2_dx;
;
L0128:	lda     _p2_dx
	asl     a
	bcc     L0129
	inc     _p2_dx
;
; if(p2_dx > 0 && p2_x < 255) p2_x += p2_dx;
;
L0129:	lda     _p2_dx
	sec
	sbc     #$01
	bvs     L0083
	eor     #$80
L0083:	bpl     L012F
	lda     _p2_x
	cmp     #$FF
	bcs     L012F
	lda     _p2_dx
	clc
	adc     _p2_x
	sta     _p2_x
;
; if(p2_dx < 0 && p2_x > 0) p2_x += p2_dx;
;
L012F:	lda     _p2_dx
	asl     a
	bcc     L0135
	lda     _p2_x
	beq     L0135
	lda     _p2_dx
	clc
	adc     _p2_x
	sta     _p2_x
;
; if((pad2 & PAD_A) && ((p2_y == FLOOR_Y) || 
;
L0135:	lda     _pad2
	and     #$80
	jeq     L0143
	lda     _p2_y
	cmp     #$C0
	jeq     L0142
;
; ( (p2_y < FLOOR_Y) && (p2_y >= (platforms[0].y - 22)) && (p2_x + 8 > platforms[0].x) && (p2_x < platforms[0].x + platforms[0].w) ) ||
;
	cmp     #$C0
	bcs     L0137
	lda     _p2_y
	jsr     pusha0
	lda     _platforms+1
	sec
	sbc     #$16
	bcs     L0092
	ldx     #$FF
L0092:	jsr     tosicmp
	bmi     L0137
	ldx     #$00
	lda     _p2_x
	clc
	adc     #$08
	bcc     L0093
	inx
L0093:	jsr     pushax
	lda     _platforms
	jsr     tosicmp0
	bmi     L0137
	beq     L0137
	lda     _p2_x
	jsr     pusha0
	lda     _platforms
	clc
	adc     _platforms+2
	bcc     L00E2
	ldx     #$01
L00E2:	jsr     tosicmp
	jmi     L0142
;
; ( (p2_y < FLOOR_Y) && (p2_y >= (platforms[1].y - 22)) && (p2_x + 8 > platforms[1].x) && (p2_x < platforms[1].x + platforms[1].w) ) ||
;
L0137:	lda     _p2_y
	cmp     #$C0
	bcs     L0139
	lda     _p2_y
	jsr     pusha0
	lda     _platforms+4
	sec
	sbc     #$16
	bcs     L0097
	ldx     #$FF
L0097:	jsr     tosicmp
	bmi     L0139
	ldx     #$00
	lda     _p2_x
	clc
	adc     #$08
	bcc     L0098
	inx
L0098:	jsr     pushax
	lda     _platforms+3
	jsr     tosicmp0
	bmi     L0139
	beq     L0139
	lda     _p2_x
	jsr     pusha0
	lda     _platforms+3
	clc
	adc     _platforms+5
	bcc     L00E3
	ldx     #$01
L00E3:	jsr     tosicmp
	bmi     L0142
;
; ( (p2_y < FLOOR_Y) && (p2_y >= (platforms[2].y - 22)) && (p2_x + 8 > platforms[2].x) && (p2_x < platforms[2].x + platforms[2].w) ) ) ){
;
L0139:	lda     _p2_y
	cmp     #$C0
	bcs     L0143
	lda     _p2_y
	jsr     pusha0
	lda     _platforms+7
	sec
	sbc     #$16
	bcs     L009C
	ldx     #$FF
L009C:	jsr     tosicmp
	bmi     L0143
	ldx     #$00
	lda     _p2_x
	clc
	adc     #$08
	bcc     L009D
	inx
L009D:	jsr     pushax
	lda     _platforms+6
	jsr     tosicmp0
	bmi     L0143
	beq     L0143
	lda     _p2_x
	jsr     pusha0
	lda     _platforms+6
	clc
	adc     _platforms+8
	bcc     L00E4
	ldx     #$01
L00E4:	jsr     tosicmp
	bpl     L0143
;
; p2_dy = -8;
;
L0142:	lda     #$F8
	sta     _p2_dy
;
; if (p2_dy < 4) p2_dy += 1;
;
L0143:	lda     _p2_dy
	sec
	sbc     #$04
	bvc     L00A5
	eor     #$80
L00A5:	bpl     L0144
	inc     _p2_dy
;
; p2_y += p2_dy;
;
L0144:	lda     _p2_dy
	clc
	adc     _p2_y
	sta     _p2_y
;
; if(p2_dy >= 0){
;
	ldx     _p2_dy
	jmi     L014B
;
; if(p2_y >= FLOOR_Y){
;
	lda     _p2_y
	cmp     #$C0
	lda     #$00
	bcc     L0148
;
; p2_y = FLOOR_Y;
;
	lda     #$C0
	sta     _p2_y
;
; p2_dy = 0;
;
	lda     #$00
	sta     _p2_dy
;
; for(i = 0; i < 3; i++){
;
L0148:	sta     _i
L0149:	lda     _i
	cmp     #$03
	jcs     L014B
;
; if (p2_y >= (platforms[i].y-22) && p2_y < (platforms[i].y-22) + 8){
;
	lda     _p2_y
	jsr     pusha0
	lda     _i
	jsr     mulax3
	clc
	adc     #<(_platforms)
	sta     ptr1
	txa
	adc     #>(_platforms)
	sta     ptr1+1
	ldy     #$01
	ldx     #$00
	lda     (ptr1),y
	sec
	sbc     #$16
	bcs     L00B0
	dex
L00B0:	jsr     tosicmp
	jmi     L014A
	lda     _p2_y
	jsr     pusha0
	lda     _i
	jsr     mulax3
	clc
	adc     #<(_platforms)
	sta     ptr1
	txa
	adc     #>(_platforms)
	sta     ptr1+1
	ldy     #$01
	ldx     #$00
	lda     (ptr1),y
	sec
	sbc     #$16
	bcs     L00B2
	dex
L00B2:	clc
	adc     #$08
	bcc     L00B3
	inx
L00B3:	jsr     tosicmp
	jpl     L014A
;
; if (p2_x + 8 > platforms[i].x && p2_x < platforms[i].x + platforms[i].w){
;
	ldx     #$00
	lda     _p2_x
	clc
	adc     #$08
	bcc     L00B7
	inx
L00B7:	jsr     pushax
	ldx     #$00
	lda     _i
	jsr     mulax3
	sta     ptr1
	txa
	clc
	adc     #>(_platforms)
	sta     ptr1+1
	ldy     #<(_platforms)
	lda     (ptr1),y
	jsr     tosicmp0
	bmi     L014A
	beq     L014A
	lda     _p2_x
	jsr     pusha0
	lda     _i
	jsr     mulax3
	sta     ptr1
	txa
	clc
	adc     #>(_platforms)
	sta     ptr1+1
	ldy     #<(_platforms)
	lda     (ptr1),y
	sta     sreg
	ldx     #$00
	lda     _i
	jsr     mulax3
	clc
	adc     #<(_platforms)
	sta     ptr1
	txa
	adc     #>(_platforms)
	sta     ptr1+1
	ldy     #$02
	ldx     #$00
	lda     (ptr1),y
	clc
	adc     sreg
	bcc     L00E6
	inx
L00E6:	jsr     tosicmp
	bpl     L014A
;
; p2_y = (platforms[i].y-22);
;
	ldx     #$00
	lda     _i
	jsr     mulax3
	clc
	adc     #<(_platforms)
	sta     ptr1
	txa
	adc     #>(_platforms)
	sta     ptr1+1
	ldy     #$01
	lda     (ptr1),y
	sec
	sbc     #$16
	sta     _p2_y
;
; p2_dy = 0;
;
	lda     #$00
	sta     _p2_dy
;
; for(i = 0; i < 3; i++){
;
L014A:	inc     _i
	jmp     L0149
;
; if( (pad2 & PAD_B) && (b2 == 0)){
;
L014B:	lda     _pad2
	and     #$40
	beq     L0150
	lda     _b2
	bne     L0150
;
; b2_y = p2_y + 2;
;
	lda     _p2_y
	clc
	adc     #$02
	sta     _b2_y
;
; b2 = 1;
;
	lda     #$01
	sta     _b2
;
; if(p2_facing == 0){
;
	lda     _p2_facing
	bne     L014F
;
; b2_x = p2_x - 4;
;
	lda     _p2_x
	sec
	sbc     #$04
	sta     _b2_x
;
; b2_vx = -4;
;
	lda     #$FC
	sta     _b2_vx
;
; p2_dx = 8;
;
	lda     #$08
;
; } else {
;
	jmp     L00F0
;
; b2_x = p2_x + 4;
;
L014F:	lda     _p2_x
	clc
	adc     #$04
	sta     _b2_x
;
; b2_vx = 4;
;
	lda     #$04
	sta     _b2_vx
;
; p2_dx = -8;
;
	lda     #$F8
L00F0:	sta     _p2_dx
;
; if(b2 == 1){
;
L0150:	lda     _b2
	cmp     #$01
	bne     L0153
;
; oam_spr(b2_x, b2_y, 0x02, 0);
;
	jsr     decsp3
	lda     _b2_x
	ldy     #$02
	sta     (c_sp),y
	lda     _b2_y
	dey
	sta     (c_sp),y
	lda     #$02
	dey
	sta     (c_sp),y
	tya
	jsr     _oam_spr
;
; b2_x += b2_vx;
;
	lda     _b2_vx
	clc
	adc     _b2_x
	sta     _b2_x
;
; if(b2_x > 250) b2 = 0;
;
	cmp     #$FB
	bcc     L0153
	lda     #$00
	sta     _b2
;
; if(b1 == 1){
;
L0153:	lda     _b1
	cmp     #$01
	bne     L0155
;
; if( (b1_x >= p2_x) && (b1_x <= p2_x + 15) && (b1_y >= p2_y) && (b1_y <= p2_y + 15) ){
;
	lda     _b1_x
	cmp     _p2_x
	bcc     L0155
	lda     _b1_x
	jsr     pusha0
	lda     _p2_x
	clc
	adc     #$0F
	bcc     L00CB
	ldx     #$01
L00CB:	jsr     tosicmp
	beq     L00F1
	bpl     L0155
L00F1:	lda     _b1_y
	cmp     _p2_y
	bcc     L0155
	lda     _b1_y
	jsr     pusha0
	lda     _p2_y
	clc
	adc     #$0F
	bcc     L00CC
	ldx     #$01
L00CC:	jsr     tosicmp
	bmi     L00CD
	bne     L0155
;
; p1_x = 40;
;
L00CD:	lda     #$28
	sta     _p1_x
;
; p2_x = 200;
;
	lda     #$C8
	sta     _p2_x
;
; p1_y = 200;
;
	sta     _p1_y
;
; p2_y = 200;
;
	sta     _p2_y
;
; b1 = 0;
;
	lda     #$00
	sta     _b1
;
; b2 = 0;
;
	sta     _b2
;
; if(b2 == 1){
;
L0155:	lda     _b2
	cmp     #$01
	bne     L00D0
;
; if( (b2_x >= p1_x) && (b2_x <= p1_x + 15) && (b2_y >= p1_y) && (b2_y <= p1_y + 15) ){
;
	lda     _b2_x
	cmp     _p1_x
	bcc     L00D0
	lda     _b2_x
	jsr     pusha0
	lda     _p1_x
	clc
	adc     #$0F
	bcc     L00D2
	ldx     #$01
L00D2:	jsr     tosicmp
	beq     L00F2
	bpl     L00D0
L00F2:	lda     _b2_y
	cmp     _p1_y
	bcc     L00D0
	lda     _b2_y
	jsr     pusha0
	lda     _p1_y
	clc
	adc     #$0F
	bcc     L00D3
	ldx     #$01
L00D3:	jsr     tosicmp
	bmi     L00D4
	bne     L00D0
;
; p1_x = 40;
;
L00D4:	lda     #$28
	sta     _p1_x
;
; p2_x = 200;
;
	lda     #$C8
	sta     _p2_x
;
; p1_y = 200;
;
	sta     _p1_y
;
; p2_y = 200;
;
	sta     _p2_y
;
; b1 = 0;
;
	lda     #$00
	sta     _b1
;
; b2 = 0;
;
	sta     _b2
;
; oam_spr(p1_x, p1_y, 0x41, 0);
;
L00D0:	jsr     decsp3
	lda     _p1_x
	ldy     #$02
	sta     (c_sp),y
	lda     _p1_y
	dey
	sta     (c_sp),y
	lda     #$41
	dey
	sta     (c_sp),y
	tya
	jsr     _oam_spr
;
; oam_spr(p1_x + 8, p1_y, 0x42, 0);
;
	jsr     decsp3
	lda     _p1_x
	clc
	adc     #$08
	ldy     #$02
	sta     (c_sp),y
	lda     _p1_y
	dey
	sta     (c_sp),y
	lda     #$42
	dey
	sta     (c_sp),y
	tya
	jsr     _oam_spr
;
; oam_spr(p1_x, p1_y + 8, 0x43, 0);
;
	jsr     decsp3
	lda     _p1_x
	ldy     #$02
	sta     (c_sp),y
	lda     _p1_y
	clc
	adc     #$08
	dey
	sta     (c_sp),y
	lda     #$43
	dey
	sta     (c_sp),y
	tya
	jsr     _oam_spr
;
; oam_spr(p1_x + 8, p1_y + 8, 0x44, 0);
;
	jsr     decsp3
	lda     _p1_x
	clc
	adc     #$08
	ldy     #$02
	sta     (c_sp),y
	lda     _p1_y
	clc
	adc     #$08
	dey
	sta     (c_sp),y
	lda     #$44
	dey
	sta     (c_sp),y
	tya
	jsr     _oam_spr
;
; oam_spr(p2_x, p2_y, 0x41, 0);
;
	jsr     decsp3
	lda     _p2_x
	ldy     #$02
	sta     (c_sp),y
	lda     _p2_y
	dey
	sta     (c_sp),y
	lda     #$41
	dey
	sta     (c_sp),y
	tya
	jsr     _oam_spr
;
; oam_spr(p2_x + 8, p2_y, 0x42, 0);
;
	jsr     decsp3
	lda     _p2_x
	clc
	adc     #$08
	ldy     #$02
	sta     (c_sp),y
	lda     _p2_y
	dey
	sta     (c_sp),y
	lda     #$42
	dey
	sta     (c_sp),y
	tya
	jsr     _oam_spr
;
; oam_spr(p2_x, p2_y + 8, 0x43, 0);
;
	jsr     decsp3
	lda     _p2_x
	ldy     #$02
	sta     (c_sp),y
	lda     _p2_y
	clc
	adc     #$08
	dey
	sta     (c_sp),y
	lda     #$43
	dey
	sta     (c_sp),y
	tya
	jsr     _oam_spr
;
; oam_spr(p2_x + 8, p2_y + 8, 0x44, 0);
;
	jsr     decsp3
	lda     _p2_x
	clc
	adc     #$08
	ldy     #$02
	sta     (c_sp),y
	lda     _p2_y
	clc
	adc     #$08
	dey
	sta     (c_sp),y
	lda     #$44
	dey
	sta     (c_sp),y
	tya
	jsr     _oam_spr
;
; while (1){
;
	jmp     L0011

.endproc

